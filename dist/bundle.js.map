{"version":3,"sources":["webpack://PluginAPI/webpack/universalModuleDefinition","webpack://PluginAPI/webpack/bootstrap","webpack://PluginAPI/./js/AH5Communicator.js","webpack://PluginAPI/./js/ArticleCommunicator.js","webpack://PluginAPI/./js/Listeners.js","webpack://PluginAPI/./js/PluginAPI.js"],"names":["module","exports","PluginAPI","selectedPluginElement","AH5Communicator","DEBUG","on","pluginElementSelected","pluginElementDeselected","elementData","prototype","getActiveEditor","callback","request","registerMenuAction","action","registerHoverAction","getSelectedPluginElement","deSelectPluginElements","directionalCastle","elementId","direction","registerMenuActionGroup","group","getEditorType","replaceElementById","id","element","replacePluginElementById","setElementContentById","content","deleteElementById","getHTMLById","getHTMLBySelector","selector","getCategories","getParentCategories","category","getParentIds","getTagTypes","getTagType","clear","insertString","string","insertElement","options","select","outerHTML","removeClasses","classes","addClasses","getDataAttribute","attribute","updateDataAttribute","value","markAsActive","setAttributeById","setStyleById","initMenu","menus","openPluginElementEditor","getTotalWordCount","getTotalCharCount","updateAssetOption","dpArticleId","key","updateAssetData","data","getAssetData","insertNestedAsset","parentElementId","markup","self","createEmbeddedObject","embeddedTypeId","insert","updateEmbeddedAssetRequest","internalId","$element","$","attr","assetSource","externalId","dpDigitalAssetId","assetClass","addClass","html","Editor","d","document","createElement","innerHTML","firstChild","setAttribute","assetContainer","querySelector","isMultiple","append","get","insertEmbeddedAsset","updateContent","getAppName","showErrorMsg","Error","addEmbeddedAssetRequest","dataset","classList","add","getCurrentSelectionAbsolutePosition","wrapSelection","className","attributes","removeInPlace","triggerEvent","event","ArticleCommunicator","focusPlugin","focusApp","startPlugin","name","app","option","startApp","stopPlugin","stopApp","getId","getPackageId","getPackageGuid","clearMetaInfo","getTags","getCustomMeta","setCustomMeta","setMetaChanged","setTags","tags","save","addTags","errorFunction","onError","addTag","tag","removeTag","getSelectedCategories","saveCategories","categories","setCategories","addCategories","removeCategories","setMainCategory","getSource","setSource","source","getStatus","setStatus","status","getPublishedDatetime","setPublishedDatetime","published","getAuthors","setAuthors","authors","addAuthors","removeAuthors","setKeywords","keywords","getKeywords","getCurrentContent","setCurrentContent","setSubArticleContent","articleId","getArticletypeId","setArticletypeId","articletypeId","articletype","maximizePluginWindow","title","onClose","Date","getTime","eventListeners","removeAll","maximizeAppWindow","restorePluginWindow","restoreAppWindow","getByline","setByline","byline","setGeolocations","geolocations","getGeolocations","getProperties","setProperties","properties","setProperty","getTopic","setTopic","topic","getPackage","Listeners","_listeners","listeners","createCallback","eventName","hasOwnProperty","callWrapper","undefined","push","length","index","payload","returnValue","forEach","listenerFn","res","params","apply","ah5Communicator","articleCommunicator","Api","queryParameters","window","location","search","substr","split","queryPair","Version","Article","errorListeners","appName","jwt","standAlone","pm","bind","createEventFunction","updateObject","type","eventKey","map","notify","callSpec","console","info","getPluginName","func","remove","arguments","createCallbackObject","random","Math","floor","eventFunction","val","target","parent","success","error","origin","hash","openTagCreationDialog","reloadIframe","setPluginName","setAppName","showInfoMsg","msg","message","showWarningMsg","showLoader","hideLoader","__loadArticleRevision","revision","createTag","searchDrLib","query","access","secure","convertDomToHTML","dom","wrap","domClone","cloneNode","wrapper","appendChild","generateArticleUrl","extendApi","a","callExtendedApi","getCurrentUser","getConfiguration","getDrPublishConfiguration","setConfiguration","config","onlyPublication","emit","increaseRequiredActionCounter","decreaseRequiredActionCounter","clearRequiredActionCounter","setRequiredActionCounter","count","create","typeId","getEmbeddedObjectTypes","giveFocus","pluginName","argument","start","hide","createModal","updateModal","closeModal","destroy","getModalInputs","confirmAuthenticated","isStandAlone","getJWT","replaceEditorComponentsExtension","clearEditorComponentsExtension","highlightAnnotation","underemphasizeAnnotations","registerExternallyDefinedProperties"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PluginAPI\"] = factory();\n\telse\n\t\troot[\"PluginAPI\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./js/PluginAPI.js\");\n","/**\n * @typedef {Object} selectedPluginElementData\n *\n * @property {String} id The DOM id of the selected element\n * @property {String} dpArticleId\n * @property {String} externalId\n * @property {Boolean} isDigitalAsset\n */\n\n/**\n * @param {Api} PluginAPI\n * @return {AH5Communicator}\n */\nmodule.exports = function (PluginAPI) {\n\n\t/** @type {selectedPluginElementData|null} */\n\tlet selectedPluginElement = null;\n\n\t/**\n\t * This will be used by editor apps to communicate with the editor\n\t *\n\t * Should be used like this:\n\t *\n\t * PluginAPI.Editor.insertString('string');\n\t *\n\t * @class\n\t * @classdesc Functions for talking with the AH5 editor. Accessed through PluginAPI.Editor\n\t * @exports PluginAPI/Editor\n\t */\n\t/* eslint max-statements: [\"error\", 50, { \"ignoreTopLevelFunctions\": true }]*/\n\tconst AH5Communicator = function () {\n\t\tthis.DEBUG = false;\n\t\tPluginAPI.on('pluginElementClicked', pluginElementSelected);\n\t\tPluginAPI.on('pluginElementDeselected', pluginElementDeselected);\n\n\t\t/**\n\t\t * @param {selectedPluginElementData} elementData\n\t\t */\n\t\tfunction pluginElementSelected(elementData) {\n\t\t\tselectedPluginElement = elementData;\n\t\t}\n\n\t\tfunction pluginElementDeselected() {\n\t\t\tselectedPluginElement = null;\n\t\t}\n\t};\n\n\t/**\n\t * Get name of current active editor\n\t *\n\t * @param {Function} callback function(String)\n\t */\n\tAH5Communicator.prototype.getActiveEditor = function (callback) {\n\t\tPluginAPI.request('get-active-editor', null, callback);\n\t};\n\n\t/**\n\t * Registers/Modifies a context menu items for a plugin element\n\t * The object send should have the following structure\n\t *\n\t * @param {Object} action The action object\n\t * @param {Function} callback function()\n\t *\n\t * @example\n\t * PluginAPI.Editor.registerMenuAction({\n\t *\t  label: 'label in the menu',\n\t *\t  icon: '[Optional] url to possible icon image',\n\t *\t  trigger: '[Optional] css selector, only show menu element when this matches the element',\n\t *\t  callback: function(id, clickedElementId) {\n\t *\t\t  // callback function\n\t *\t\t  // first parameter is id of the plugin element\n\t *\t\t  // second paramter is id of closest element to the trigger element that has an id\n\t *\t\t  //\t  in code: $(event.triggerElement).closest('[id]').attr('id');\n\t *\t  }\n\t * })\n\t */\n\tAH5Communicator.prototype.registerMenuAction = function (action, callback) {\n\t\tPluginAPI.request('register-menu-action', action, callback);\n\t};\n\n\t/**\n\t * Adds a mouseover action to plugin elements\n\t *\n\t * @param {function} action to perform\n\t * @param {function} callback function(String)\n\t */\n\tAH5Communicator.prototype.registerHoverAction = function (action, callback) {\n\t\tPluginAPI.request('register-hover-action', action, callback);\n\t};\n\n\t/**\n\t * Gets the selected plugin element from the editor\n\t *\n\t * @param {function} callback function(String)\n\t */\n\tAH5Communicator.prototype.getSelectedPluginElement = function (callback) {\n\t\tPluginAPI.request('get-selected-plugin-element', {}, callback);\n\t};\n\n\t/**\n\t * Deselect all plugin elements in editor\n\t *\n\t * @param {function} callback function(String)\n\t */\n\tAH5Communicator.prototype.deSelectPluginElements = function (callback) {\n\t\tPluginAPI.request('de-select-plugin-elements', {}, callback);\n\t};\n\n\t/**\n\t * Swap positions between the provided element and the adjacent one\n\t * in the specified direction\n\t * PluginAPI.Editor.directionalCastle({\n\t *  elementId: 'the provided element id',\n\t *  direction: 'forward/backward'\n\t * })\n\t *  @param {String} elementId DOM element id\n\t *  @param {String} direction Direction\n\t *  @param {function} callback\n\t * */\n\tAH5Communicator.prototype.directionalCastle = function (elementId, direction, callback) {\n\t\tPluginAPI.request('editor-directional-castle', {\n\t\t\telementId: elementId,\n\t\t\tdirection: direction\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Registers/Modifies a group of items to in the context menu\n\t * The object send should have the following structure\n\t *\n\t * @example\n\t * PluginAPI.Editor.registerMenuActionGroup({\n\t *\t  label: 'label for the group in the menu',\n\t *\t  icon: '[Optional] url to possible icon image',\n\t *\t  actions: [\n\t *\t\t  {\n\t *\t\t\t  label: 'label for the action #1',\n\t *\t\t\t  callback: function(id, clickedElementId) {\n\t *\t\t\t\t  // same as for registerMenuAction\n\t *\t\t\t  }\n\t *\t\t  },\n\t *\t\t  {\n\t *\t\t\t  label: 'label for the action #2',\n\t *\t\t\t  callback: function(id, clickedElementId) {\n\t *\t\t\t\t  // same as for registerMenuAction\n\t *\t\t\t  }\n\t *\t\t  }\n\t *\t  ]\n\t * })\n\t *\n\t * @param {Object} group The action object\n\t * @param {function} callback function()\n\t */\n\tAH5Communicator.prototype.registerMenuActionGroup = function (group, callback) {\n\t\tPluginAPI.request('register-menu-action-group', group, callback);\n\t};\n\n\t/**\n\t * Retrieves the type of editor that currently has focus\n\t *\n\t * @param {function} callback function(String)\n\t */\n\tAH5Communicator.prototype.getEditorType = function (callback) {\n\t\tPluginAPI.request('editor-get-type', null, callback);\n\t};\n\n\t/**\n\t * Replace an element in the article\n\t *\n\t * @param {String} id Id of the element\n\t * @param {String} element The new element\n\t * @param {function} callback function(Boolean), called after replacement is done\n\t */\n\tAH5Communicator.prototype.replaceElementById = function (id, element, callback) {\n\t\tPluginAPI.request('editor-element-replace-byid', {\n\t\t\tid: id,\n\t\t\telement: element\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Replace a plugin element in the article\n\t *\n\t * @param {String} id Id of the element\n\t * @param {String} element The new element\n\t * @param {function} callback function(Boolean), called after replacement is done\n\t */\n\tAH5Communicator.prototype.replacePluginElementById = function (id, element, callback) {\n\t\tPluginAPI.request('editor-element-replace-plugin-element-byid', {\n\t\t\tid: id,\n\t\t\telement: element\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Set the content of an element in the article\n\t *\n\t * @param {String} id Id of the element\n\t * @param {String} content The new content\n\t * @param {function} callback function(Boolean), called when done\n\t */\n\tAH5Communicator.prototype.setElementContentById = function (id, content, callback) {\n\t\tPluginAPI.request('editor-element-set-byid', {\n\t\t\tid: id,\n\t\t\telement: content\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Delete an element in the article\n\t *\n\t * @param {String} id Id of the element\n\t * @param {function} callback function(Boolean), called after deletion is done\n\t */\n\tAH5Communicator.prototype.deleteElementById = function (id, callback) {\n\t\tPluginAPI.request('editor-element-delete-byid', {\n\t\t\tid: id\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Get HTML code of an element\n\t *\n\t * @param {String} id The element id\n\t * @param {function} callback function(String), html content of the element\n\t */\n\tAH5Communicator.prototype.getHTMLById = function (id, callback) {\n\t\tPluginAPI.request('editor-element-get-byid', {\n\t\t\tid: id\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Get HTML code of all elements that match the selector\n\t *\n\t * @param {String} selector The CSS selector\n\t * @param {function} callback function([String]), html content of matching elements\n\t */\n\tAH5Communicator.prototype.getHTMLBySelector = function (selector, callback) {\n\t\tPluginAPI.request('editor-elements-get-byselector', {\n\t\t\tselector: selector\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Get all categories\n\t *\n\t * @param {Function} callback function([Object Category]), list of Category objects with id, name and pid\n\t */\n\tAH5Communicator.prototype.getCategories = function (callback) {\n\t\tPluginAPI.request('get-categories', null, callback);\n\t};\n\n\t/**\n\t * Returns all the parent categories of the given category\n\t *\n\t * @param {Object} category The category to find parents of\n\t * @param {Function} callback function([Object Category]), array of parent Category objects\n\t */\n\tAH5Communicator.prototype.getParentCategories = function (category, callback) {\n\t\tPluginAPI.request('get-parent-categories', category, callback);\n\t};\n\n\t/**\n\t * Returns all the parent elements that match the selector\n\t *\n\t * @param {String} id Id of element to find parents of\n\t * @param {String} selector Selector to filter parent elements with\n\t * @param {Function} callback function([String]), array of ids\n\t */\n\tAH5Communicator.prototype.getParentIds = function (id, selector, callback) {\n\t\tPluginAPI.request('get-parent-ids', {\n\t\t\tid: id,\n\t\t\tselector: selector\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Retrieve information about all tagtypes\n\t *\n\t * @param {Function} callback function([Object Tagtype]), array of tagtypes with id, name and config object\n\t */\n\tAH5Communicator.prototype.getTagTypes = function (callback) {\n\t\tPluginAPI.request('get-tag-types', null, callback);\n\t};\n\n\t/**\n\t * Get information about the given tagtype\n\t *\n\t * @param {String} id The element id\n\t * @param {Function} callback function(Object Tagtype), tagtype object with id, name and config object\n\t */\n\tAH5Communicator.prototype.getTagType = function (id, callback) {\n\t\tPluginAPI.request('get-tag-type', {\n\t\t\tid: id\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Clears the editor contents\n\t *\n\t * @param {Function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.clear = function (callback) {\n\t\tPluginAPI.request('editor-clear', null, callback);\n\t};\n\n\t/**\n\t * Insert a string into the editor\n\t *\n\t * @param {String} string The string that should be inserted\n\t * @param {Function} callback function(String), id of the newly inserted element if it has one\n\t */\n\tAH5Communicator.prototype.insertString = function (string, callback) {\n\t\tPluginAPI.request('editor-insert-string', {\n\t\t\tstring: string\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Insert an element into the editor\n\t *\n\t * Note that the HTML of the element is what will be transferred, and nothing else!\n\t * The element will be given the class dp-plugin-element, and given a unique ID (if none is present)\n\t *\n\t * @param {Element} element The element that should be inserted\n\t * @param {Object | Function} options (can be omitted) Options object, supports option 'select' - set to true to automatically select the inserted element\n\t * @param {Function} [callback] function(String), id of the newly inserted element\n\t */\n\tAH5Communicator.prototype.insertElement = function (element, options, callback) {\n\t\tlet select = false;\n\t\tif (typeof options === 'object') {\n\t\t\toptions = options || {};\n\t\t\tselect = typeof options.select === 'boolean' ? options.select : false;\n\t\t} else if (typeof callback === 'undefined' && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t}\n\t\tPluginAPI.request('editor-insert-element', {\n\t\t\telement: element.outerHTML,\n\t\t\tselect: select,\n\t\t\toptions: options\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Remove classes from the element an element in the article\n\t *\n\t * @param {String} id Id of the element\n\t * @param {Array} classes Array of class names\n\t * @param {function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.removeClasses = function (id, classes, callback) {\n\t\tPluginAPI.request('editor-classes-remove', {\n\t\t\tid: id,\n\t\t\tclasses: classes\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Add new classes to an element\n\t *\n\t * @param {String} id Id of the element\n\t * @param {Array} classes Array of class names\n\t * @param {function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.addClasses = function (id, classes, callback) {\n\t\tPluginAPI.request('editor-classes-add', {\n\t\t\tid: id,\n\t\t\tclasses: classes\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Get data-attribute of the element\n\t *\n\t * @param {String} id Id of the element\n\t * @param {String} attribute attribute name\n\t * @param {function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.getDataAttribute = function (id, attribute, callback) {\n\t\tPluginAPI.request('editor-attribute-get', {\n\t\t\tid: id,\n\t\t\tattribute: 'data-' + attribute\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Update data-attribute of the element\n\t *\n\t * @param {String} id Id of the element\n\t * @param {String} attribute attribute name\n\t * @param {String} value attribute value\n\t * @param {function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.updateDataAttribute = function (id, attribute, value, callback) {\n\t\tPluginAPI.request('editor-attribute-update', {\n\t\t\tid: id,\n\t\t\tattribute: 'data-' + attribute,\n\t\t\tvalue: value\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Mark an element as currently selected (green border with default styling)\n\t *\n\t * @param {String} id Id of the element\n\t * @param {function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.markAsActive = function (id, callback) {\n\t\tPluginAPI.request('editor-mark-as-active', {\n\t\t\tid: id\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Sets the attribute of the element with the given ID to value\n\t *\n\t * @param {String} id The ID of the element to set the attribute on\n\t * @param {String} attribute The attribute to set\n\t * @param {String} value What to set the attribute to\n\t * @param {Function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.setAttributeById = function (id, attribute, value, callback) {\n\t\tPluginAPI.request('editor-element-attribute-set-byid', {\n\t\t\tid: id,\n\t\t\tattribute: attribute,\n\t\t\tvalue: value\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Sets a style of the element with the given ID to value\n\t *\n\t * @param {String} id The ID of the element to set the attribute on\n\t * @param {String} attribute The style attribute to set\n\t * @param {String} value What to set the attribute to\n\t * @param {Function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.setStyleById = function (id, attribute, value, callback) {\n\t\tPluginAPI.request('editor-element-style-set-byid', {\n\t\t\tid: id,\n\t\t\tattribute: attribute,\n\t\t\tvalue: value\n\t\t}, callback);\n\t};\n\n\n\t/**\n\t * Initialize pre registered menus\n\t *\n\t * Available options are: simplePluginMenu, editContext, deleteButton, floatButtons\n\t *\n\t * @param {Array} menus Array of menu names\n\t * @param {Function} callback function(Boolean)\n\t */\n\tAH5Communicator.prototype.initMenu = function (menus, callback) {\n\t\tPluginAPI.request('editor-initialize-menu', {\n\t\t\tmenus: menus\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Opens the plugin editor for a given element.\n\t *\n\t * @param {String} id Plugin element ID\n\t */\n\tAH5Communicator.prototype.openPluginElementEditor = function (id) {\n\t\tPluginAPI.request('open-element-editor', {\n\t\t\tid: id\n\t\t});\n\t};\n\n\t/**\n\t * Returns the total number of words in the currently open article.\n\t *\n\t * @param {Function} callback Receives the total word count as its single parameter\n\t */\n\tAH5Communicator.prototype.getTotalWordCount = function (callback) {\n\t\tPluginAPI.request('total-word-count', null, callback);\n\t};\n\n\t/**\n\t * Returns the total number of characters in the currently open article.\n\t *\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t */\n\tAH5Communicator.prototype.getTotalCharCount = function (callback) {\n\t\tPluginAPI.request('total-char-count', null, callback);\n\t};\n\n\t/**\n\t * Update one data option of the referenced embedded asset\n\t *\n\t * @param {Number} dpArticleId DrPublish's embedded asset id\n\t * @param {String} key Name of the property\n\t * @param {String} value Value of the property\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t */\n\tAH5Communicator.prototype.updateAssetOption = function (dpArticleId, key, value, callback) {\n\t\tPluginAPI.request('update-asset-option', {dpArticleId: dpArticleId, key: key, value: value}, callback);\n\t};\n\n\t/**\n\t * Update all asset data of the referenced embedded asset\n\t *\n\t * @param {Object} data Updated data\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t *\n\t * @example\n\t *  var data = {\n\t *   internalId: assetDpArticleId,\n\t *   assetElementId: activeAssetId,\n\t *   assetType: 'picture',\n\t *   assetSource: PluginAPI.getPluginName(),\n\t *   resourceUri: fullsizeUrl,\n\t *   previewUri: fullsizeUrl,\n\t *   renditions: {\n\t *       highRes: {uri: fullsizeUrl},\n\t *       thumbnail: {uri: thumbnailUrl}\n\t *   },\n\t *   options: {}\n\t * }\n\t * PluginAPI.Editor.updateAssetData(data);\n\t */\n\tAH5Communicator.prototype.updateAssetData = function (data, callback) {\n\t\tPluginAPI.request('update-asset-media', data, callback);\n\t};\n\n\t/**\n\t * Get all data option of the referenced embedded asset\n\t *\n\t * @param {Number} dpArticleId DrPublish's embedded asset id\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t */\n\tAH5Communicator.prototype.getAssetData = function (dpArticleId, callback) {\n\t\tPluginAPI.request('get-asset-data', {data: dpArticleId}, callback);\n\t};\n\n\t/**\n\t * Insert an embedded asset inside of an existing one\n\t *\n\t * @param {Number} parentElementId DOM element id of the receiving asset\n\t * @param {String} markup HTML to inject\n\t * @param {Object} data Asset data\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t *\n\t * @example\n\t * var title = response.data.title ? response.data.title : '';\n\t * var caption = response.data.description ? response.data.description : '';\n\t * var credit = response.data.byline ? response.data.byline : '';\n\t * var source = response.data.source ? response.data.source : '';\n\t * var markup = '<div class=\"dp-article-image-container\"><img src=\"' + fullsizeUrl + '\" /></div>';\n\t * markup += '<div class=\"dp-article-image-headline\" data-dp-editable-type=\"textfield\" data-dp-editable-name=\"headline\">' + title + '</div>...';\n\t * var options = response.data.options ? response.data.options : {};\n\t * var callback = function () {\n\t *   // do something here\n\t *  };\n\t * var rends = renditions || {};\n\t * rends.highRes = {uri: fullsizeUrl};\n\t * rends.preview = {uri: fullsizeUrl};\n\t * var drpdata = {\n\t *               embeddedTypeId: 5,\n\t *               isMultiple: true,\n\t *               assetType: 'picture',\n\t *               externalId: id,\n\t *               assetClass: 'dp-picture',\n\t *               assetSource: 'images',\n\t *               resourceUri: fullsizeUrl,\n\t *               previewUri: fullsizeUrl,\n\t *               renditions: rends,\n\t *               options: options\n\t *           };\n\t * var  insertNested = function () {\n\t *   PluginAPI.Editor.insertNestedAsset(\n\t *       selectedSlideshowAsset.id,\n\t *       markup,\n\t *       drpdata\n\t * };\n\t * PluginAPI.Editor.getSelectedPluginElement(insertNested);\n\t */\n\tAH5Communicator.prototype.insertNestedAsset = function (parentElementId, markup, data, callback) {\n\t\tconst self = this;\n\t\tPluginAPI.createEmbeddedObject(\n\t\t\tdata.embeddedTypeId,\n\t\t\t(dpArticleId) => {\n\t\t\t\tinsert(dpArticleId, parentElementId, (data) => {\n\t\t\t\t\treturn updateEmbeddedAssetRequest(callback);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\n\t\tfunction insert(dpArticleId, parentElementId, callback) {\n\t\t\tdata.internalId = dpArticleId;\n\t\t\tconst elementId = 'asset-' + dpArticleId;\n\t\t\tconst $element = $('<div />');\n\t\t\t$element.attr('id', elementId);\n\t\t\t$element.attr('data-internal-id', dpArticleId);\n\t\t\t$element.attr('data-ah5-type', data.assetSource);\n\t\t\tif (data.externalId) {\n\t\t\t\t$element.attr('data-external-id', data.externalId);\n\t\t\t}\n\t\t\tif (data.dpDigitalAssetId) {\n\t\t\t\t$element.attr('data-dp-digital-asset-id', data.dpDigitalAssetId);\n\t\t\t}\n\t\t\tif (data.assetClass) {\n\t\t\t\t$element.addClass(data.assetClass);\n\t\t\t}\n\t\t\t$element.addClass('dp-plugin-element');\n\t\t\t$element.html(markup);\n\t\t\tPluginAPI.Editor.getHTMLById(parentElementId, (html) => {\n\t\t\t\tlet d = document.createElement('div');\n\t\t\t\td.innerHTML = html;\n\t\t\t\td.firstChild.setAttribute('id', parentElementId + 'tmp');\n\t\t\t\tself.replacePluginElementById(parentElementId, d.innerHTML, () => {\n\t\t\t\t\td = document.createElement('div');\n\t\t\t\t\td.innerHTML = html;\n\t\t\t\t\tconst assetContainer = d.querySelector('.dp-fact-box-image, .dp-nested-asset-container');\n\t\t\t\t\tif (data.isMultiple) {\n\t\t\t\t\t\t$(assetContainer).append($element.get(0).outerHTML);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tassetContainer.innerHTML = $element.get(0).outerHTML;\n\t\t\t\t\t}\n\t\t\t\t\tself.replacePluginElementById(parentElementId + 'tmp', d.innerHTML, callback);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction updateEmbeddedAssetRequest(callback) {\n\t\t\tPluginAPI.request('update-embedded-asset', data, callback);\n\t\t}\n\t};\n\n\t/**\n\t * Insert an embedded asset\n\t *\n\t * @param {String} markup HTML to inject\n\t * @param {Object} data Asset data\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t *\n\t * @example\n\t * var title = response.data.title ? response.data.title : '';\n\t * var caption = response.data.description ? response.data.description : '';\n\t * var credit = response.data.byline ? response.data.byline : '';\n\t * var source = response.data.source ? response.data.source : '';\n\t * var markup = '<div class=\"dp-article-image-container\"><img src=\"' + fullsizeUrl + '\" /></div>';\n\t * markup += '<div class=\"dp-article-image-headline\" data-dp-editable-type=\"textfield\" data-dp-editable-name=\"headline\">' + title + '</div>';\n\t * markup += '<div class=\"dp-article-image-caption\" data-dp-editable-type=\"html\" data-dp-editable-name=\"caption\">' + caption + '</div>...';\n\t * var options = response.data.options ? response.data.options : {};\n\t * var callback = function () {\n\t *   // do something here\n\t *  };\n\t * var rends = renditions || {};\n\t * rends.highRes = {uri: fullsizeUrl};\n\t * rends.preview = {uri: fullsizeUrl};\n\t * var drpdata = {\n\t *               embeddedTypeId: 5,\n\t *               isMultiple: true,\n\t *               assetType: 'picture',\n\t *               externalId: id,\n\t *               assetClass: 'dp-picture',\n\t *               assetSource: 'images',\n\t *               resourceUri: fullsizeUrl,\n\t *               previewUri: fullsizeUrl,\n\t *               renditions: rends,\n\t *               options: options\n\t *           };\n\t * PluginAPI.Editor.insertEmbeddedAsset(markup, drpdata, callback);\n\t */\n\tAH5Communicator.prototype.insertEmbeddedAsset = function (markup, data, callback) {\n\t\tconst self = this;\n\t\tlet updateContent = false;\n\t\tif (selectedPluginElement) {\n\t\t\tif (data.assetSource !== PluginAPI.getAppName()) {\n\t\t\t\tPluginAPI.showErrorMsg('Can\\'t update selected plugin element since it doesn\\'t belong to the \\'' + PluginAPI.getAppName() + '\\' plugin');\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tupdateContent = true;\n\t\t\t}\n\t\t}\n\n\t\tif (selectedPluginElement) {\n\t\t\tconst dpArticleId = selectedPluginElement.dpArticleId;\n\t\t\tif (!dpArticleId) {\n\t\t\t\tthrow Error('Selected plugin element: expected dpArticleId not found (tried reading from attribute \\'data-internal-id\\')');\n\t\t\t}\n\t\t\tinsert(dpArticleId, (data) => {\n\t\t\t\treturn updateEmbeddedAssetRequest(typeof callback === 'function' ? callback(data) : null);\n\t\t\t});\n\t\t} else {\n\t\t\tPluginAPI.createEmbeddedObject(\n\t\t\t\tdata.embeddedTypeId,\n\t\t\t\t(dpArticleId) => {\n\t\t\t\t\tinsert(dpArticleId, (data) => {\n\t\t\t\t\t\treturn addEmbeddedAssetRequest(typeof callback === 'function' ? callback(data) : null);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tfunction insert(dpArticleId, callback) {\n\t\t\tdata.internalId = dpArticleId;\n\t\t\tconst elementId = 'asset-' + dpArticleId;\n\t\t\tconst element = document.createElement('div');\n\t\t\telement.id = elementId;\n\t\t\telement.dataset.internalId = dpArticleId;\n\t\t\tif (data.externalId) {\n\t\t\t\telement.dataset.externalId = data.externalId;\n\t\t\t}\n\t\t\tif (data.dpDigitalAssetId) {\n\t\t\t\telement.dataset.dpDigitalAssetId = data.dpDigitalAssetId;\n\t\t\t}\n\t\t\tif (data.assetClass) {\n\t\t\t\telement.classList.add(data.assetClass);\n\t\t\t}\n\t\t\telement.innerHTML = markup;\n\t\t\tif (!updateContent) {\n\t\t\t\tdata.select = true;\n\t\t\t\tself.insertElement(element, data);\n\t\t\t} else {\n\t\t\t\tself.setElementContentById(elementId, element.innerHTML, null);\n\t\t\t}\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn callback();\n\t\t\t}\n\t\t}\n\n\t\tfunction addEmbeddedAssetRequest(callback) {\n\t\t\tPluginAPI.request('add-embedded-asset', data, callback);\n\t\t}\n\n\t\tfunction updateEmbeddedAssetRequest(callback) {\n\t\t\tPluginAPI.request('update-embedded-asset', data, callback);\n\t\t}\n\t};\n\n\t/**\n\t * Returns the total number of characters in the currently open article.\n\t *\n\t * @param {Function} callback Receives the total character count as its single parameter\n\t */\n\tAH5Communicator.prototype.getCurrentSelectionAbsolutePosition = function (callback) {\n\t\tPluginAPI.request('current-selection-absolute-position', null, callback);\n\t};\n\n\t/**\n\t * Wraps the current selection in a span\n\t *\n\t * @param {String} className the name of the class to apply\n\t * @param {Object} attributes to apply to the wrapper\n\t * @param {Function} callback\n\t */\n\tAH5Communicator.prototype.wrapSelection = function (className, attributes, callback) {\n\t\tPluginAPI.request('wrap-selection', {className: className, attributes: attributes}, callback);\n\t};\n\n\t/**\n\t * Removes the selected element, leaving all children in place\n\t *\n\t * @param {String} selector the selector for finding the elements to be removed\n\t * @param {Function} callback\n\t */\n\tAH5Communicator.prototype.removeInPlace = function (selector, callback) {\n\t\tPluginAPI.request('remove-in-place', {selector: selector}, callback);\n\t};\n\n\t/**\n\t * Triggers an event on all elements matching the selector\n\t *\n\t * @param {String} selector the selector for finding the elements\n\t * @param {String} event the event to trigger on the found elements\n\t * @param {Function} callback\n\t */\n\tAH5Communicator.prototype.triggerEvent = function (selector, event, callback) {\n\t\tPluginAPI.request('trigger-event', {selector: selector, event: event}, callback);\n\t};\n\n\treturn new AH5Communicator();\n};\n","/* eslint max-statements: [\"error\", 100000000] */\n/* eslint complexity: [\"error\", 100000000] */\nmodule.exports = function (PluginAPI) {\n\n\t/**\n     * This class is used for communicating with the article, typically setting and getting values of metadata or in the article content itself.\n     *\n     * @class\n     * @classdesc Functions for talking with the DrPublish article object. Accessed through PluginAPI.Article\n     * @exports PluginAPI/Article\n     */\n\tconst ArticleCommunicator = function () {\n\t\tthis.DEBUG = false;\n\t};\n\n\t/**\n     * Give focus to yourself\n     *\n     * @param {Function} callback function(Boolean), called as the plugin gets focus\n     */\n\tArticleCommunicator.prototype.focusPlugin = function (callback) {\n\t\tPluginAPI.request('app-focus', {}, callback);\n\t};\n\n\t/**\n     * Give focus to yourself\n     * @deprecated use focusPlugin instead\n     * @param {Function} callback function(Boolean), called after plugin is started\n     */\n\tArticleCommunicator.prototype.focusApp = function (callback) {\n\t\tthis.focusPlugin(callback);\n\t};\n\n\t/**\n     * Start the given plugin\n     *\n     * @param {String} name Name of the plugin as defined on publication settings\n     * @param {Object} options Options for initializing the plugin\n     * @param {Function} callback function(Boolean), called after plugin is started\n     */\n\tArticleCommunicator.prototype.startPlugin = function (name, options, callback) {\n\t\tPluginAPI.request('app-start', {\n\t\t\tapp: name,\n\t\t\toption: options\n\t\t}, callback);\n\t};\n\n\t/**\n     * @deprecated use startPlugin instead\n     * @param {String} name Name of the plugin as defined on publication settings\n     * @param {Object} options Options for initializing the plugin\n     * @param {Function} callback function(Boolean), called after plugin is started\n     */\n\tArticleCommunicator.prototype.startApp = function (name, options, callback) {\n\t\tthis.startPlugin(name, options, callback);\n\t};\n\n\t/**\n     * Stop the given plugin\n     *\n     * @param {String} name Name of the plugin, as defined on publication config\n     */\n\tArticleCommunicator.prototype.stopPlugin = function (name) {\n\t\tPluginAPI.request('app-stop', {\n\t\t\tapp: name\n\t\t});\n\t};\n\n\t/**\n     * @deprecated use  stopPlugin instead\n     * @param {String} name Name of the plugin, as defined on publication config\n     */\n\tArticleCommunicator.prototype.stopApp = function (name) {\n\t\tthis.stopPlugin(name);\n\t};\n\n\t/**\n     * Get the id of the article currently edited\n     *\n     * @param {Function} callback function(Int), id of the current article\n     */\n\tArticleCommunicator.prototype.getId = function (callback) {\n\t\tPluginAPI.request('article-id-get', null, callback);\n\t};\n\n\t/**\n     * Get the guid of the article package currently edited\n     *\n     * @param {Function} callback function(Int), id of the current article\n     */\n\tArticleCommunicator.prototype.getPackageId = function (callback) {\n\t\tPluginAPI.request('package-id-get', null, callback);\n\t};\n\n\t/**\n     * Get the guid of the article package currently edited\n     *\n     * @param {Function} callback function(Int), id of the current article\n     */\n\tArticleCommunicator.prototype.getPackageGuid = function (callback) {\n\t\tPluginAPI.request('package-guid-get', null, callback);\n\t};\n\n\t/**\n     * Clear the meta information summary\n     *\n     * @param {Function} callback function(Boolean), called when meta data has been cleared\n     */\n\tArticleCommunicator.prototype.clearMetaInfo = function (callback) {\n\t\tPluginAPI.request('article-metainfo-clear', null, callback);\n\t};\n\n\t/**\n     * Get tags used in the article\n     *\n     * @param {Function} callback function([Object Tag]), array with tags connected to an article\n     */\n\tArticleCommunicator.prototype.getTags = function (callback) {\n\t\tPluginAPI.request('article-tags-get', null, callback);\n\t};\n\n\t/**\n     * Retrieve custom meta value for the article\n     *\n     * @param {String} name Name of the custom meta value\n     * @param {Function} callback function(Object), the parameter is an object containing the given custom meta value\n     */\n\tArticleCommunicator.prototype.getCustomMeta = function (name, callback) {\n\t\tPluginAPI.request('article-custom-meta-get', {\n\t\t\tname: name\n\t\t}, callback);\n\t};\n\n\t/**\n     * Set custom meta value for the article\n     *\n     * @param {String} name Name of the meta value\n     * @param {Object} value Value to set\n     * @param {Function} callback function()\n     */\n\tArticleCommunicator.prototype.setCustomMeta = function (name, value, callback) {\n\t\tPluginAPI.request('article-custom-meta-set', {\n\t\t\tname: name,\n\t\t\tvalue: value\n\t\t}, callback);\n\t};\n\n\t/**\n     * Marks article model as having meta data changes\n     *\n     * @param {Function} callback function()\n     */\n\tArticleCommunicator.prototype.setMetaChanged = function (callback) {\n\t\tPluginAPI.request('article-meta-changed', null, callback);\n\t};\n\n\t/**\n     * Set tags for the article\n     *\n     * @param {Array} tags List of tags that should be set\n     * @param {Boolean} save Set to true to force save once the tags are updated\n     * @param {Function} callback function(Boolean), called when tags have been set\n     */\n\tArticleCommunicator.prototype.setTags = function (tags, save, callback) {\n\t\tPluginAPI.request('article-tags-set', {\n\t\t\tsave: save,\n\t\t\ttags: tags\n\t\t}, callback);\n\t};\n\n\t/**\n     * Add tag for the article\n     *\n     * @param {Array} tags Tags to be added\n     * @param {Function} errorFunction called if error\n     * @param {Function} callback function(Boolean), called when tag has been set\n     */\n\tArticleCommunicator.prototype.addTags = function (tags, errorFunction, callback) {\n\t\tPluginAPI.request('article-tags-add', {\n\t\t\ttags: tags,\n\t\t\tonError: errorFunction\n\t\t}, callback);\n\t};\n\n\t/**\n     * Add tag for the article\n     *\n     * @param {String} tag Tag to be added\n     * @param {Function} errorFunction called if error\n     * @param {Function} callback function(Boolean), called when tag has been set\n     */\n\tArticleCommunicator.prototype.addTag = function (tag, errorFunction, callback) {\n\t\tPluginAPI.request('article-tags-add', {\n\t\t\ttags: [tag],\n\t\t\tonError: errorFunction\n\t\t}, callback);\n\t};\n\n\t/**\n     * Add tags for the article\n     *\n     * @param {String} tags Tags to be added\n     * @param {Function} errorFunction called if error\n     * @param {Function} callback function(Boolean), called when tag has been set\n     */\n\tArticleCommunicator.prototype.addTags = function (tags, errorFunction, callback) {\n\t\tPluginAPI.request('article-tags-add', {\n\t\t\ttags: tags,\n\t\t\tonError: errorFunction\n\t\t}, callback);\n\t};\n\n\t/**\n     * Remove tag from article\n     *\n     * @param {String} tag Tag to remove\n     * @param {Function} callback function(Boolean), called when tag has been removed\n     */\n\tArticleCommunicator.prototype.removeTag = function (tag, callback) {\n\t\tPluginAPI.request('article-tags-remove', {\n\t\t\ttag: tag\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the selected categories\n     *\n     * @param {Function} callback function([String]), array with category ids\n     */\n\tArticleCommunicator.prototype.getSelectedCategories = function (callback) {\n\t\tPluginAPI.request('article-categories-selected-get', null, callback);\n\t};\n\n\t/**\n     * Save the currently selected categories\n     *\n     * @param {Function} callback function(Boolean), called when categories has been saved\n     */\n\tArticleCommunicator.prototype.saveCategories = function (callback) {\n\t\tthis.getSelectedCategories(function (categories) {\n\t\t\tthis.setCategories(categories, callback);\n\t\t});\n\t};\n\n\t/**\n     * Set selected categories\n     *\n     * @param {Array} categories List of category IDs that should be set\n     * @param {Function} callback function(Boolean), called when categories have been set\n     */\n\tArticleCommunicator.prototype.setCategories = function (categories, callback) {\n\t\tPluginAPI.request('article-categories-selected-set', {\n\t\t\tcategories: categories\n\t\t}, callback);\n\t};\n\n\t/**\n     * Add the given categories to the list of categories\n     *\n     * @param {Array} categories List of category IDs to add\n     * @param {Function} callback function(Boolean), called when the categories have been set\n     */\n\tArticleCommunicator.prototype.addCategories = function (categories, callback) {\n\n\t\tPluginAPI.request('article-categories-add', {\n\t\t\tcategories: categories\n\t\t}, callback);\n\t};\n\n\t/**\n     * Remove the given categories from the list of categories\n     *\n     * @param {Array} categories List of category IDs to remove\n     * @param {Function} callback function(Boolean), called when the categories have been removed\n     */\n\tArticleCommunicator.prototype.removeCategories = function (categories, callback) {\n\t\tPluginAPI.request('article-categories-remove', {\n\t\t\tcategories: categories\n\t\t}, callback);\n\t};\n\n\t/**\n     * Set the main category of the current article\n     *\n     * @param {Number} category The ID of the category to set as the main category\n     * @param {Function} callback function(Boolean), called when the main category has been set\n     */\n\tArticleCommunicator.prototype.setMainCategory = function (category, callback) {\n\t\tPluginAPI.request('article-categories-main-set', {\n\t\t\tcategory: category\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the source set for the article\n     *\n     * @param {Function} callback function(String), name of the source\n     */\n\tArticleCommunicator.prototype.getSource = function (callback) {\n\n\t\tPluginAPI.request('article-source-get', null, callback);\n\t};\n\n\t/**\n     * Set the source for the article\n     *\n     * @param {String} value The new value to be set as source\n     * @param {Function} callback function(Boolean), called when the source has been set\n     */\n\tArticleCommunicator.prototype.setSource = function (value, callback) {\n\t\tPluginAPI.request('article-source-set', {\n\t\t\tsource: value\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the status for the article\n     *\n     * @param {Function} callback function(String), current status\n     */\n\tArticleCommunicator.prototype.getStatus = function (callback) {\n\t\tPluginAPI.request('article-status-get', null, callback);\n\t};\n\n\t/**\n     * Set the status for the article\n     *\n     * @param {String} status The new status to be set (draft, waiting, published)\n     * @param {Function} callback function(Boolean), called when the source has been set\n     */\n\tArticleCommunicator.prototype.setStatus = function (status, callback) {\n\t\tPluginAPI.request('article-status-set', {\n\t\t\tstatus: status\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the published-date\n     *\n     * @param {Function} callback function(String), current published datetime\n     */\n\tArticleCommunicator.prototype.getPublishedDatetime = function (callback) {\n\t\tPluginAPI.request('article-published-get', null, callback);\n\t};\n\n\t/**\n     * Set the published-date\n     *\n     * @param {String} published Date to be set (YYYY-MM-DD HH:MM:SS)\n     * @param {Function} callback function(Boolean), called when done\n     */\n\tArticleCommunicator.prototype.setPublishedDatetime = function (published, callback) {\n\t\tPluginAPI.request('article-published-set', {\n\t\t\tpublished: published\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the authors set in the article\n     *\n     * @param {Function} callback function([String]), currently set authors\n     */\n\tArticleCommunicator.prototype.getAuthors = function (callback) {\n\t\tPluginAPI.request('article-authors-get', null, callback);\n\t};\n\n\t/**\n     * Set authors for the article\n     *\n     * @param {Array} authors List of authors that should be set\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.setAuthors = function (authors, callback) {\n\t\tPluginAPI.request('article-authors-set', {\n\t\t\tauthors: authors\n\t\t}, callback);\n\t};\n\n\t/**\n     * Add the given authors to the list of authors\n     *\n     * @param {Array} authors List of authors to add\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.addAuthors = function (authors, callback) {\n\t\tPluginAPI.request('article-authors-add', {\n\t\t\tauthors: authors\n\t\t}, callback);\n\t};\n\n\t/**\n     * Remove the given authors from the list of authors\n     *\n     * @param {Array} authors List of authors to remove\n     * @param {Function} callback function([String]), author list as it is after the authors has been removed\n     */\n\tArticleCommunicator.prototype.removeAuthors = function (authors, callback) {\n\t\tPluginAPI.request('article-authors-remove', {\n\t\t\tauthors: authors\n\t\t}, callback);\n\t};\n\n\t/**\n     * Set the keyword-list on the article\n     *\n     * @param {Array} keywords List of keywords to add\n     * @param {Function} callback Function to call when keywords have been set\n     */\n\tArticleCommunicator.prototype.setKeywords = function (keywords, callback) {\n\t\tPluginAPI.request('article-keywords-set', {\n\t\t\tkeywords: keywords\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the current set of keywords on the article\n     *\n     * @param {Function} callback Function to call with the result\n     */\n\tArticleCommunicator.prototype.getKeywords = function (callback) {\n\t\tPluginAPI.request('article-keywords-get', null, callback);\n\t};\n\n\t/**\n     * Gets the main article content\n     *\n     * @param {Function} callback function(Object Content)\n     */\n\tArticleCommunicator.prototype.getCurrentContent = function (callback) {\n\t\tPluginAPI.request('article-content-get', null, callback);\n\t};\n\n\t/**\n     * Updates main article content\n     *\n     * @param {String} content The new content for the article\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.setCurrentContent = function (content, callback) {\n\t\tPluginAPI.request('article-content-set', {\n\t\t\tcontent: content\n\t\t}, callback);\n\t};\n\t/**\n     * Updates sub article content\n     *\n     * @param {Integer} articleId Sub article id\n     * @param {String} content The new content for the sub article\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.setSubArticleContent = function (articleId, content, callback) {\n\t\tPluginAPI.request('sub-article-content-set', {\n\t\t\tarticleId: articleId,\n\t\t\tcontent: content\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get the article type of the current article\n     *\n     * @param {Function} callback function(Int)\n     */\n\tArticleCommunicator.prototype.getArticletypeId = function (callback) {\n\t\tPluginAPI.request('article-type-get', null, callback);\n\t};\n\n\t/**\n     * Set the article type of the current article\n     *\n     * @param {Number} articletypeId The new article type of the article\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.setArticletypeId = function (articletypeId, callback) {\n\t\tPluginAPI.request('article-type-set', {\n\t\t\tarticletype: articletypeId\n\t\t}, callback);\n\t};\n\n\t/**\n     * Maximize the plugin view\n     *\n     * @param {String} title Title to give the maximized view\n     * @param {function} onClose Function to call when the window is closed/minimized\n\t * @param {Function} callback function(Boolean)\n     */\n\tArticleCommunicator.prototype.maximizePluginWindow = function (title, onClose, callback) {\n\t\tconst event = 'editor-pane-close-' + new Date().getTime();\n\n\t\tPluginAPI.request('editor-pane-maximize', {\n\t\t\ttitle: title,\n\t\t\tevent: event\n\t\t}, callback);\n\t\tPluginAPI.eventListeners.removeAll(event);\n\t\tPluginAPI.eventListeners.add(event, onClose);\n\t};\n\n\t/**\n     * @deprecated use maximizePluginWindow instead\n     *  @param {String} title Window title\n     *  @param {function} onClose Callback to call after everything is done\n\t *  @param {Function} callback function(Boolean), called when it has been set\n     *\n     */\n\tArticleCommunicator.prototype.maximizeAppWindow = function (title, onClose, callback) {\n\t\tthis.maximizePluginWindow(title, onClose, callback);\n\t};\n\n\t/**\n     * Restore the plugin pane to the default size\n     *\n     * @param {function} callback Callback to call after everything is done\n     */\n\tArticleCommunicator.prototype.restorePluginWindow = function (callback) {\n\t\tPluginAPI.request('restore-app-window', {}, callback);\n\t};\n\n\t/**\n     * Restore the plugin pane to the default size\n     *\n     * @deprecated use restorPluginWindow instead\n     * @param {function} callback Callback to call after everything is done\n     */\n\tArticleCommunicator.prototype.restoreAppWindow = function (callback) {\n\t\tthis.restorePluginWindow(callback);\n\t};\n\n\t/**\n     * Get the current byline\n     *\n     * @param {function} callback function(String), xml string with the current byline\n     */\n\tArticleCommunicator.prototype.getByline = function (callback) {\n\t\tPluginAPI.request('article-byline-get', null, callback);\n\t};\n\n\t/**\n     * Set the byline\n     *\n     * @param {String} byline XML version of byline to use\n     * @param {Boolean} save If true, force save after updating byline information\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.setByline = function (byline, save, callback) {\n\t\tPluginAPI.request('article-byline-set', {\n\t\t\tsave: save,\n\t\t\tbyline: byline\n\t\t}, callback);\n\t};\n\n\t/**\n     * Set geolocation\n     *\n     * @param {Object} geolocations The location to set\n     * @param {Function} callback function(Boolean), called when it has been set\n     */\n\tArticleCommunicator.prototype.setGeolocations = function (geolocations, callback) {\n\t\tPluginAPI.request('article-geolocations-set', {\n\t\t\tgeolocations: geolocations\n\t\t}, callback);\n\t};\n\n\t/**\n     * Get geolocation\n     *\n     * @param {Function} callback function(Object), retrieves the currently set geo location\n     */\n\tArticleCommunicator.prototype.getGeolocations = function (callback) {\n\t\tPluginAPI.request('article-geolocations-get', null, callback);\n\t};\n\n\t/**\n     * Fetches a list of all properties available to an article.\n     *\n     * @param {Function} callback Callback called with an array of property objects.\n     */\n\tArticleCommunicator.prototype.getProperties = function (callback) {\n\t\tPluginAPI.request('article-properties-get', null, callback);\n\t};\n\n\t/**\n     * Updates and saves one or more property values. The input is a simple object with property names and their\n     * new value. The supplied callback is called with an updated list of properties.\n     *\n     * @example\n     * PluginAPI.Article.setProperties({\n     *     fooProperty: \"bar\",\n     *     barProperty: \"foo\"\n     * }, function(properties) {\n     *     // Returns a complete and updated list of properties.\n     * })\n     *\n     * @param {Object} properties An object of property names and corresponding values.\n     * @param {Function} callback Callback called with an updated list of properties.\n     */\n\tArticleCommunicator.prototype.setProperties = function (properties, callback) {\n\t\tPluginAPI.request('article-properties-set', {\n\t\t\tproperties: properties\n\t\t}, callback);\n\t};\n\n\t/**\n     * Updates and saves a single property.\n     *\n     * @param {String} name The property to update.\n     * @param {Object} value The updated value.\n     * @param {Function} callback Callback called with an updated list of properties.\n     */\n\tArticleCommunicator.prototype.setProperty = function (name, value, callback) {\n\t\tconst data = {};\n\t\tdata[name] = value;\n\t\tPluginAPI.request('article-properties-set', {\n\t\t\tproperties: data\n\t\t}, callback);\n\t};\n\n\tArticleCommunicator.prototype.getTopic = function (callback) {\n\t\tPluginAPI.request('article-topic-get', null, callback);\n\t};\n\n\tArticleCommunicator.prototype.setTopic = function (name, callback) {\n\t\tPluginAPI.request('article-topic-set', {\n\t\t\ttopic: name\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Get article package data, including content of sub articles\n\t *\n\t * @param {Function} callback function(Object)\n\t */\n\tArticleCommunicator.prototype.getPackage = function (callback) {\n\t\tPluginAPI.request('package-get', null, callback);\n\t};\n\n\treturn new ArticleCommunicator();\n\n};\n","/**\n * @example\n * PluginAPI.on('afterCreate', function() {\n *     PluginAPI.Article.setSource('Ny Times');\n * });\n * PluginAPI.on('beforeSave', function() {\n *     if (!articleIsAwesome()) {\n *          return false;\n *     }\n * });\n *\n * @description\n *\n * <p>DrPublish provides a large set of default events that an plugin can listen for. All events that start their name with &#39;before&#39; can be stopped by an plugin. This is done by returning &#39;false&#39; from the callback function, as in the &#39;beforSave&#39; example given bellow. </p>\n * <p>Other plugins can also supply their own events using the PluginAPI.emit(...) function. Documention on these events are up to each plugin to create.</p>\n * <h3 id=\"available-events\">Available Events</h3>\n * <p><code>addCategory</code></p>\n * <blockquote>\n * <p><em>triggered after a category has been added to the article</em></p>\n * </blockquote>\n * <p><code>addTag</code></p>\n * <blockquote>\n * <p><em>triggered after a tag had been added to the article</em></p>\n * </blockquote>\n * <p><code>pluginWindowMaximized</code></p>\n * <blockquote>\n * <p><em>triggered when the plugin pane is maximized</em></p>\n * </blockquote>\n * <p><code>pluginWindowRestored</code></p>\n * <blockquote>\n * <p><em>triggered when the plugin pane is restored to its&#39; original size</em></p>\n * </blockquote>\n * <p><code>changedCustomMeta</code></p>\n * <blockquote>\n * <p><em>triggered when a custom meta property is changed/set, parameter is an object with property name and value</em></p>\n * </blockquote>\n * <p><code>receivedFocus</code></p>\n * <blockquote>\n * <p><em>triggered when a plugin receives focus. Receives a parameter object that has two predefined values: <code>previousPluginName</code> - name of previous plugin, <code>givenFocus</code> - true when focus was sent from another plugin. The parameter object can also contain other keys supplied by the plugin losing focus.</em></p>\n * </blockquote>\n * <p><code>afterCreate</code></p>\n * <blockquote>\n *     <p><em>triggered after a new article has been created</p></em>\n * </blockquote>\n * <p><code>beforeDelete</code></p>\n * <blockquote>\n *     <p><em>triggered before an article is deleted</p></em>\n * </blockquote>\n * <p><code>afterDelete</code></p>\n * <blockquote>\n *     <p><em>triggered after an article has been deleted</p></em>\n * </blockquote>\n * <p><code>afterLoad</code></p>\n * <blockquote>\n *     <p><em>triggered after an article has been loaded</p></em>\n * </blockquote>\n * <p><code>afterPublish</code></p>\n * <blockquote>\n *     <p><em>triggered after an article has been published</p></em>\n * </blockquote>\n * <p><code>afterSave</code></p>\n * <blockquote>\n *     <p><em>triggered after an article has been saved</p></em>\n * </blockquote>\n * <p><code>beforeCreate</code></p>\n * <blockquote>\n *     <p><em>triggered before a new article is created</p></em>\n * </blockquote>\n * <p><code>beforeLoad</code></p>\n * <blockquote>\n *     <p><em>triggered before an article is loaded into the editor</p></em>\n * </blockquote>\n * <p><code>beforePreview</code></p>\n * <blockquote>\n *     <p><em>triggered before the article is opened in the preview</p></em>\n * </blockquote>\n * <p><code>beforeSave</code></p>\n * <blockquote>\n *     <p><em>triggered before an article is saved</p></em>\n * </blockquote>\n * <p><code>beforePublish</code></p>\n * <blockquote>\n *     <p><em>triggered before an article is published</p></em>\n * </blockquote>\n * <p><code>editorFocus</code> </p>\n * <blockquote>\n * <p><em>triggered when an editor gets focus</em></p>\n * </blockquote>\n * <p><code>editorUnfocus</code> </p>\n * <blockquote>\n * <p><em>triggered when an editor loses focus</em></p>\n * </blockquote>\n * <p><code>editorsLostFocus</code> </p>\n * <blockquote>\n * <p><em>triggered when all editors loses focus</em></p>\n * </blockquote>\n * <p><code>editorReady</code></p>\n * <blockquote>\n *     <p><em>triggered when the editor has been fully loaded and is ready for input</p></em>\n * </blockquote>\n * <p><code>modifiedContent</code></p>\n * <blockquote>\n *     <p><em>triggered whenever content changes in the article</p></em>\n * </blockquote>\n * <p><code>elementRemoved</code></p>\n * <blockquote>\n * <p><em>triggered when a plugin element from the current plugin is removed, receives an object with element id as a parameter</em></p>\n * </blockquote>\n * <p><code>pluginElementClicked</code></p>\n * <blockquote>\n *     <p><em>triggered when someone clicks on a plugin element in the editor</p></em>\n * </blockquote>\n * <p><code>pluginElementSelected</code></p>\n * <blockquote>\n *     <p><em>triggers when someone selects a plugin element in the editor</p></em>\n * </blockquote>\n * <p><code>pluginElementDeselected</code></p>\n * <blockquote>\n *     <p><em>triggered when someone deselects a plugin element in the editor</p></em>\n * </blockquote>\n */\nclass Listeners {\n\tconstructor() {\n\t\tthis._listeners = {};\n\t}\n\n\n\t/**\n\t * @deprecated Use PluginAPI.on(...) instead\n\t * @param {Object} listeners\n\t */\n\taddAll(listeners) {\n\t\tconst PluginAPI = require('./PluginAPI');\n\t\t'use strict';\n\t\tconst createCallback = function (callback) {\n\t\t\treturn function (data) {\n\t\t\t\tcallback(data.data);\n\t\t\t};\n\t\t};\n\t\tfor (const eventName in listeners) {\n\t\t\tif (listeners.hasOwnProperty(eventName)) {\n\t\t\t\tconst callback = listeners[eventName];\n\t\t\t\tconst callWrapper = createCallback(callback);\n\t\t\t\tPluginAPI.on(eventName, callWrapper);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new listener\n\t *\n\t * @param {String} event Event name\n\t * @param {Function} callback Function to call when an even of the type is received\n\t * @return {number}\n\t */\n\tadd(event, callback) {\n\n\t\tif (typeof callback !== 'function') {\n\t\t\tthrow new Error('not a function');\n\t\t}\n\n\t\tif (this._listeners[event] === undefined) {\n\t\t\tthis._listeners[event] = [];\n\t\t}\n\n\t\tthis._listeners[event].push(callback);\n\t\treturn this._listeners[event].length - 1;\n\t}\n\n\t/**\n\t * Removes the listener at the given index\n\t *\n\t * @param {String} event Event type\n\t * @param {Function} index The index of the event handler to remove\n\t */\n\tremove(event, index) {\n\n\t\tif (this._listeners[event] === undefined || this._listeners[event][index] === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\t/*\n\t\t * Set to null instead of remove to retain callback indexes\n\t\t */\n\t\tthis._listeners[event][index] = false;\n\t}\n\n\t/**\n\t * Removes all listeners for the given event type, or if !event then removes all listeners\n\t *\n\t * @param {String} event Event type to remove handlers for (!event for all)\n\t */\n\tremoveAll(event) {\n\t\tif (!event) {\n\t\t\tthis._listeners = [];\n\t\t} else {\n\t\t\tthis._listeners[event] = [];\n\t\t}\n\t}\n\n\t/**\n\t * Notifies all registered listeners that an event has occurred\n\t *\n\t * @param {String} event Event type\n\t * @param {Object} payload The event data\n\t * @return {Boolean}\n\t */\n\tnotify(event, payload) {\n\t\tlet returnValue = true;\n\t\tif (this._listeners[event] === undefined) {\n\t\t\treturn returnValue;\n\t\t}\n\n\t\t// If the payload is an object with a key data, we use that value as the payload we pass to the listener functions.\n\t\t// This is needed as we have some inconsistencies in how we pass data around. This normalization should preferably\n\t\t// be done at the call site.\n\t\tthis._listeners[event].forEach((listenerFn) => {\n\t\t\tif (typeof listenerFn !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet res = null;\n\t\t\tif (payload && payload.params && payload.params === true) {\n\t\t\t\tres = listenerFn.apply(null, payload.data);\n\t\t\t} else if (typeof payload === 'object' && payload !== null && typeof payload.data !== 'undefined') {\n\t\t\t\tres = listenerFn(payload.data);\n\t\t\t} else {\n\t\t\t\tres = listenerFn(payload);\n\t\t\t}\n\t\t\tif (res === false) {\n\t\t\t\treturnValue = false;\n\t\t\t}\n\t\t});\n\t\treturn returnValue;\n\t}\n\n}\n\nmodule.exports = Listeners;\n","/* eslint max-statements: [\"error\", 100000000] */\n/* eslint complexity: [\"error\", 100000000] */\n/* global pm */\n\nconst ah5Communicator = require('./AH5Communicator');\nconst articleCommunicator = require('./ArticleCommunicator');\nconst Listeners = require('./Listeners');\n\nconst PluginAPI = (function () {\n\n\t/**\n\t *\n\t * Namespace for all public DrPublish methods available from plugins.\n\t *\n\t * @class\n\t * @classdesc The basic API object\n\t * @exports PluginAPI\n\t *\n\t */\n\tconst Api = function () {\n\n\t\tconst queryParameters = {};\n\t\twindow.location.search.substr(1).split('&').forEach((queryPair) => {\n\t\t\tqueryParameters[queryPair.split('=')[0]] = queryPair.split('=')[1];\n\t\t});\n\n\n\t\tthis.DEBUG = false;\n\n\t\tthis.Version = '1.0';\n\t\tthis.Editor = null;\n\t\tthis.Article = null;\n\t\tthis.errorListeners = new Listeners();\n\t\tthis.eventListeners = new Listeners();\n\t\tthis.appName = queryParameters.appName || '';\n\t\tthis.jwt = queryParameters.jwt || '';\n\t\tthis.standAlone = queryParameters.standAlone && queryParameters.standAlone === 'true' || false;\n\t\tthis.selectedPluginElement = null;\n\n\t\tconst self = this;\n\n\t\tpm.bind('event', (data) => {\n\t\t\tconst createEventFunction = function (eventName) {\n\t\t\t\treturn function (data) {\n\t\t\t\t\tPluginAPI.request(eventName, data);\n\t\t\t\t};\n\t\t\t};\n\t\t\tconst updateObject = function (data) {\n\t\t\t\tfor (const key in data) {\n\t\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (typeof data[key] === 'object' && data[key] !== null && data[key].type === 'function') {\n\t\t\t\t\t\t\tdata[key] = createEventFunction(data[key].eventKey);\n\t\t\t\t\t\t} else if (typeof data[key] === 'object' && data[key] !== null && typeof data[key].map === 'function') {\n\t\t\t\t\t\t\tdata[key] = data[key].map(updateObject);\n\t\t\t\t\t\t} else if (typeof data[key] === 'object' && data[key] !== null) {\n\t\t\t\t\t\t\tdata[key] = updateObject(data[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn data;\n\t\t\t};\n\t\t\tdata.data = updateObject(data.data);\n\n\t\t\tdata = self.eventListeners.notify(data.type, data.data);\n\t\t\tif (typeof data === 'undefined') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (data === false) {\n\t\t\t\treturn {'abort': true};\n\t\t\t}\n\t\t\treturn data;\n\t\t}, '*');\n\t};\n\n\t/**\n\t * Dispatches a request to DrPublish, and returns the reply to callback On error, notifies all error listeners based on the index .type of the thrown object\n\t *\n\t * @param {String} callSpec What do you want to call?\n\t * @param {Object} data The data attached to the request\n\t * @param {Function} callback The function to call upon return\n\t */\n\tApi.prototype.request = function (callSpec, data, callback) {\n\t\tconst self = this;\n\t\tif (this.DEBUG) {\n\t\t\tconsole.info(this.getPluginName() + ': Requesting ' + callSpec + ' from parent with data', data);\n\t\t}\n\n\t\tif (!data) {\n\t\t\tdata = {};\n\t\t}\n\n\t\tif (typeof callback === 'undefined') {\n\t\t\tcallback = null;\n\t\t}\n\n\t\tif (typeof data.length === 'number') {\n\t\t\tdata = {data: data};\n\t\t}\n\n\t\tdata['src_app'] = this.getPluginName();\n\n\t\tconst createEventFunction = function (func, eventKey) {\n\t\t\treturn function () {\n\t\t\t\tself.eventListeners.remove(eventKey, eventKey);\n\t\t\t\treturn func.apply(null, arguments);\n\t\t\t};\n\t\t};\n\n\n\t\tconst createCallbackObject = function (key, callback) {\n\t\t\tconst random = Math.floor(Math.random() * 1000);\n\t\t\tconst eventKey = key + random + 'functioncallback' + (new Date()).getTime();\n\t\t\tconst eventFunction = createEventFunction(callback, eventKey);\n\t\t\tself.eventListeners.add(eventKey, eventFunction);\n\t\t\treturn {\n\t\t\t\ttype: 'function',\n\t\t\t\teventKey: eventKey\n\t\t\t};\n\t\t};\n\n\t\tconst updateObject = function (data) {\n\t\t\tfor (const key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tconst val = data[key];\n\t\t\t\t\tif (typeof val === 'function') {\n\t\t\t\t\t\tdata[key] = createCallbackObject(key, val);\n\t\t\t\t\t} else if (typeof val === 'object' && val !== null && typeof val.map === 'function') {\n\t\t\t\t\t\tdata[key] = val.map(updateObject);\n\t\t\t\t\t} else if (typeof val === 'object' && val !== null) {\n\t\t\t\t\t\tdata[key] = updateObject(val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn data;\n\t\t};\n\t\tdata = updateObject(data);\n\n\t\tpm({\n\t\t\ttarget: parent,\n\t\t\ttype: callSpec,\n\t\t\tdata: data,\n\t\t\tsuccess: callback,\n\t\t\terror: (data) => {\n\t\t\t\tself.errorListeners.notify(data.type, data);\n\t\t\t},\n\t\t\torigin: '*', // TODO: Find a way of avoiding all-origins\n\t\t\thash: false\n\t\t});\n\t};\n\n\n\t/**\n\t * Creates a new tag\n\t *\n\t * @param {String} tag The tag to create\n\t * @param {Function} callback function(Boolean)\n\t */\n\tApi.prototype.openTagCreationDialog = function (tag, callback) {\n\t\tthis.request('create-tag', {\n\t\t\ttag: tag\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Reloads the plugins's iframe\n\t */\n\tApi.prototype.reloadIframe = function () {\n\n\t\tthis.request('app-reload', {\n\t\t\tapp: this.getPluginName()\n\t\t});\n\t};\n\n\t/**\n\t * Get the name of the loaded plugin\n\t *\n\t * @return {String} The name of the plugin, or false if it couldn't be detected\n\t */\n\tApi.prototype.getPluginName = function () {\n\t\treturn this.appName;\n\t};\n\n\t/**\n\t * Get the name of the loaded plugin\n\t * @deprecated: use getPluginName instead\n\t * @return {String} The name of the plugin, or false if it couldn't be detected\n\t */\n\tApi.prototype.getAppName = function () {\n\t\treturn this.getPluginName();\n\t};\n\n\t/**\n\t * Set the name of the plugin\n\t *\n\t * @param {String} name The name of the plugin\n\t */\n\tApi.prototype.setPluginName = function (name) {\n\t\tthis.appName = name;\n\t};\n\n\t/**\n\t * Set the name of the plugin\n\t * @deprecated: use setPluginName instead\n\t *\n\t * @param {String} name The name of the plugin\n\t */\n\tApi.prototype.setAppName = function (name) {\n\t\tthis.setPluginName(name);\n\t};\n\n\t/**\n\t * Show info-message to the user\n\t *\n\t * @param {String} msg Message to be displayed\n\t */\n\tApi.prototype.showInfoMsg = function (msg) {\n\n\t\tthis.request('show-message-info', {\n\t\t\tmessage: msg\n\t\t});\n\t};\n\n\t/**\n\t * Show warning-message to the user\n\t *\n\t * @param {String} msg Message to be displayed\n\t */\n\tApi.prototype.showWarningMsg = function (msg) {\n\n\t\tthis.request('show-message-warning', {\n\t\t\tmessage: msg\n\t\t});\n\t};\n\n\t/**\n\t * Show error-message to the user\n\t *\n\t * @param {String} msg Message to be displayed\n\t */\n\tApi.prototype.showErrorMsg = function (msg) {\n\n\t\tthis.request('show-message-error', {\n\t\t\tmessage: msg\n\t\t});\n\t};\n\n\t/**\n\t * Show the loader\n\t *\n\t * @param {String} msg Message to display in progress loader\n\t */\n\tApi.prototype.showLoader = function (msg) {\n\t\tthis.request('show-loader', {\n\t\t\tmessage: msg\n\t\t});\n\t};\n\n\t/**\n\t * Hide the loader\n\t */\n\tApi.prototype.hideLoader = function () {\n\t\tthis.request('hide-loader');\n\t};\n\n\n\t/**\n\t * Loads an old revision of an article\n\t *\n\t * @param {Number} id The id of the revision to load\n\t * @param {Function} callback The function to call when the new revision has been loaded\n\t * @private\n\t */\n\tApi.prototype.__loadArticleRevision = function (id, callback) {\n\t\tthis.request('load-revision', {\n\t\t\trevision: id\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Creates a new tag\n\t *\n\t * @param {String} tag JSON object with the tag to create, must contain tagTypeId and name properties\n\t * @param {Function} callback function(Boolean)\n\t */\n\tApi.prototype.createTag = function (tag, callback) {\n\t\tthis.request('tag-create', {\n\t\t\ttag: tag\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Sends a query to DrLib\n\t *\n\t * @example\n\t * PluginAPI.searchDrLib({\n\t *      query: 'articles.json?q=awesome',\n\t *      secure: true,\n\t *      success: function(data) {\n\t *          data.items.forEach(doStuffWithArticle);\n\t *      },\n\t *      error: function(data) {\n\t *          console.warn('something went wrong');\n\t *      }\n\t * })\n\t *\n\t * @param {Object} data Object with three properties; 'query' which is the query to send to DrLib, 'success' which is the callback to execute on success, and 'secure' a boolean to add the internal API key to the query and thus allow searching on unpublished article. This callback's parameter is an object which is the query result as an object. See the json output of DrLib to learn more about this object\n\t * @param {Function} callback function(Boolean)\n\t *\n\t */\n\tApi.prototype.searchDrLib = function (data, callback) {\n\t\tthis.request('drlib-search', {\n\t\t\tquery: data.query,\n\t\t\taccess: data.access,\n\t\t\tsecure: data.secure,\n\t\t\tsuccess: data.success,\n\t\t\terror: data.error\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Generates proper html code to represent the dom element. This is NOT an asynchronous function\n\t *\n\t * @param {Object} dom The dom node to convert\n\t * @return {String} The html code\n\t */\n\t// TODO: This function should also be able to take a DOMElement or similar.\n\tApi.prototype.convertDomToHTML = function (dom) {\n\t\tif (typeof dom === 'object' && typeof dom.wrap === 'function') {\n\t\t\treturn dom.wrap('<div>').parent().html();\n\t\t} else {\n\t\t\tconst domClone = dom.cloneNode(true);\n\t\t\tconst wrapper = document.createElement('div');\n\t\t\twrapper.appendChild(domClone);\n\t\t\treturn wrapper.innerHTML;\n\t\t}\n\t};\n\n\t/**\n\t * Generates an url to a published article\n\t *\n\t * @param {String} id The id of the article to generate url for\n\t * @param {Function} callback function(String), where the parameter is the generated url\n\t */\n\tApi.prototype.generateArticleUrl = function (id, callback) {\n\t\tthis.request('generate-article-url', {\n\t\t\tid: id\n\t\t}, callback);\n\t};\n\n\t/**\n\t * Extends the PluginAPI with custom functionality that other plugins can use\n\t *\n\t * @param {String} group Group name for functionality to add\n\t * @param {String} name Name of the specific function to add\n\t * @param {Function} action function(Object) Function to call when the API is invoked, recieves one parameter as given in PluginAPI.callExtendedApi and return value is passed back to the caller\n\t */\n\tApi.prototype.extendApi = function (group, name, action) {\n\t\tconst self = this;\n\t\tthis.request('extend-api', {\n\t\t\tgroup: group,\n\t\t\tname: name,\n\t\t\taction: (data) => {\n\t\t\t\tconst a = action(data.data);\n\t\t\t\tself.request(data.eventKey, {'data': a});\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * Call the extended PluginAPI\n\t *\n\t * @param {String} group Group name for functionality to call\n\t * @param {String} name Name of the specific function to call\n\t * @param {Object} data Data object to pass as parameter to the api call\n\t * @param {Function} callback function(Object) Function to recieve the API response, parameter is the response from the API call\n\t */\n\tApi.prototype.callExtendedApi = function (group, name, data, callback) {\n\t\tthis.request('call-extended-api', {\n\t\t\tgroup: group,\n\t\t\tname: name,\n\t\t\tdata: data,\n\t\t\tcallback: callback\n\t\t});\n\t};\n\n\t/**\n\t * Gets logged in user\n\t *\n\t * @param {Function} callback function(Object)\n\t */\n\tApi.prototype.getCurrentUser = function (callback) {\n\t\tthis.request('get-current-user', null, callback);\n\t};\n\n\t/**\n\t * Get configuration information about the plugin\n\t *\n\t * @param {Function} callback function(Object)\n\t */\n\tApi.prototype.getConfiguration = function (callback) {\n\t\tthis.request('get-configuration', null, callback);\n\t};\n\n\t/**\n\t * Get DrPublish configuration\n\t *\n\t * @param {Function} callback function(Object)\n\t */\n\tApi.prototype.getDrPublishConfiguration = function (callback) {\n\t\tthis.request('get-drpublish-configuration', null, callback);\n\t};\n\n\t/**\n\t * Set configuration information about the plugin\n\t *\n\t * @param {Object} config The configuration object to save\n\t * @param {Object} options Object, can have three keys.\n\t *      'onlyPublication' (boolean) If true the configuration is set for the current publication only\n\t *      'success' (function) Called if the configuration was saved successfully\n\t *      'error' (function) Called if there was an error, recieves and error object as first parameter\n\t * @param {Function} callback function()\n\t */\n\tApi.prototype.setConfiguration = function (config, options, callback) {\n\t\t// support old function signature\n\t\tif (typeof options === 'boolean') {\n\t\t\toptions = {\n\t\t\t\tonlyPublication: options\n\t\t\t};\n\t\t} else if (typeof options !== 'object' || options === null) {\n\t\t\toptions = {};\n\t\t}\n\t\tconst data = {\n\t\t\tconfig: config,\n\t\t\tonlyPublication: typeof options.onlyPublication === 'boolean' ? options.onlyPublication : false,\n\t\t\tsuccess: typeof options.success === 'function' ? options.success : null,\n\t\t\terror: typeof options.error === 'function' ? options.error : null\n\t\t};\n\t\tthis.request('set-configuration', data, callback);\n\t};\n\n\t/**\n\t * Emits an event to DrPublish, and possibly other apps\n\t *\n\t * @param {String} name Name of the event\n\t * @param {String} data Data object to send with the event\n\t */\n\tApi.prototype.emit = function (name, data) {\n\t\tthis.request('emit-api-event', {\n\t\t\tname: name,\n\t\t\tdata: data\n\t\t});\n\t};\n\n\t/**\n\t * Listen for an event. If the callback returns false the event may cancel continued actions, e.g beforeSave can cancel article save. Look at documentation for Listeners to learn more.\n\t *\n\t * @param {String} name Name of the event\n\t * @param {Function} callback function(Object) Function to call when the event is triggered. Recieves one data object parameter of the form {source: <source plugin name or DrPublish>, data: <data object>}\n\t */\n\tApi.prototype.on = function (name, callback) {\n\t\tconst self = this;\n\t\tself.eventListeners.add(name, callback);\n\t\tthis.request('on-api-event', {\n\t\t\tname: name\n\t\t});\n\t};\n\n\t/**\n\t * Increase the counter of actions required by the user, used to tell the user that the plugin requires input of some kind\n\t *\n\t * @param {Function} callback function(Object) function to call once the counter has been increased, returns the new counter value\n\t */\n\tApi.prototype.increaseRequiredActionCounter = function (callback) {\n\t\tthis.request('increase-required-action-counter', {}, callback);\n\t};\n\n\t/**\n\t * Decrease the counter of actions required by the user, used to tell the user that the plugin requires input of some kind\n\t *\n\t * @param {Function} callback function(Object) function to call once the counter has been decrease, returns current counter value\n\t */\n\tApi.prototype.decreaseRequiredActionCounter = function (callback) {\n\t\tthis.request('decrease-required-action-counter', {}, callback);\n\t};\n\n\t/**\n\t * Clear the counter of actions required by the user, used to tell the user that the plugin requires input of some kind\n\t *\n\t * @param {Function} callback function(Object) function to call once the counter has been cleared\n\t */\n\tApi.prototype.clearRequiredActionCounter = function (callback) {\n\t\tthis.request('clear-required-action-counter', {}, callback);\n\t};\n\n\t/**\n\t * Set the counter of actions required by the user, used to tell the user that the plugin requires input of some kind\n\t *\n\t * @param {Number} count The value to set the counter to\n\t * @param {Function} callback function(Object) function to call once the counter has been cleared\n\t */\n\tApi.prototype.setRequiredActionCounter = function (count, callback) {\n\t\tthis.request('set-required-action-counter', {count: count}, callback);\n\t};\n\n\t/**\n\t * Create a new instance of the Api class\n\t *\n\t * @private\n\t * @return {Object}\n\t */\n\tApi.prototype.create = function () {\n\t\treturn new Api();\n\t};\n\n\t/**\n\t * Create an embedded object of the given type\n\t *\n\t * @param {Number} typeId Type Id of the embedded object to create\n\t * @param {Function} callback function(embeddedObjectId) called once the object has been created, first parameter is the new embedded object id\n\t */\n\tApi.prototype.createEmbeddedObject = function (typeId, callback) {\n\t\tthis.request('create-embedded-object', {typeId: typeId, callback: callback});\n\t};\n\n\t/**\n\t * Get information about the available embedded object types\n\t *\n\t * @param {Function} callback function([Object]) recieves an array with objects describing the available embedded object types in the form of `{typeId: 'embedded object type id', cssClass: 'css class used to style the objects'}`\n\t */\n\tApi.prototype.getEmbeddedObjectTypes = function (callback) {\n\t\tthis.request('get-embedded-object-types', null, callback);\n\t};\n\n\t/**\n\t * Gives focus to another plugin\n\t *\n\t * @param {String} pluginName The name of the plugin to recieve focus\n\t * @param {Object} argument Optional option argument to pass along to the plugin recieving focus\n\t * @param {Boolean} start Flag to decide if the plugin should be started if it has not been loaded previously, default true\n\t * @return {Boolean}\n\t */\n\tApi.prototype.giveFocus = function (pluginName, argument, start) {\n\t\tif (typeof pluginName !== 'string') {\n\t\t\treturn false;\n\t\t}\n\t\tif (typeof start !== 'boolean') {\n\t\t\tstart = true;\n\t\t}\n\t\tthis.request('give-focus', {pluginName: pluginName, start: start, argument: argument});\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Hide the plugin, so it is no longer visible on the list of open plugins\n\t * @return {Boolean}\n\t */\n\tApi.prototype.hide = function () {\n\t\tthis.request('hide');\n\t\treturn true;\n\t};\n\n\t/**\n\t * <p>Creates a jQuery UI modal in the main editor window, detached from the plugin itself. Modals are unique on a\n\t * per-plugin basis, meaning that a plugin can only have a single modal at a time. Creating a new modal will\n\t * overwrite the previous.</p>\n\t *\n\t * <a href=\"http://api.jqueryui.com/dialog\">See the official documentation for a list of available options.</a></p>\n\t *\n\t * <p>Note that you do not have direct access to the DOM of the modal. Use the provided helper methods to\n\t * manipulate or read from the modal:\n\t *   <ul>\n\t *     <li><a href=\"#closeModal\">closeModal</a></li>\n\t *     <li><a href=\"#updateModal\">updateModal</a></li>\n\t *     <li><a href=\"#getModalInputs\">getModalInputs</a></li>\n\t *   </ul>\n\t * </p>\n\t *\n\t * @example\n\t *\n\t * PluginAPI.createModal('<h1>This is a modal</h1>', {\n\t *   buttons: {\n\t *     Ok: function () {\n\t *       alert('Ok!');\n\t *     }\n\t *   }\n\t * });\n\t *\n\t * PluginAPI.updateModal('<h1>This is the same modal</h1>');\n\t *\n\t * PluginAPI.createModal('<h1>This is a brand new modal</h1>', {\n\t *   buttons: {\n\t *     cancel: function() {\n\t *       PluginAPI.closeModal(true);\n\t *     }\n\t *   }\n\t * });\n\t *\n\t * @param {String} content An HTML string\n\t * @param {Object} options A standard jQuery UI options object.\n\t * @return {Boolean}\n\t */\n\tApi.prototype.createModal = function (content, options) {\n\t\tthis.request('create-custom-modal', {content: content, options: options});\n\t\treturn true;\n\t};\n\n\t/**\n\t * Updates the HTML content of a live modal. Has no effect if the modal does not exist.\n\t *\n\t * @param {String} content An HTML string\n\t * @return {Boolean}\n\t */\n\tApi.prototype.updateModal = function (content) {\n\t\tthis.request('update-custom-modal', {content: content});\n\t\treturn true;\n\t};\n\n\t/**\n\t * Closes and optionally deletes the modal. Has no effect if the modal does not exists.\n\t *\n\t * @param {Boolean} destroy Whether or not to delete the modal\n\t * @return {Boolean}\n\t */\n\tApi.prototype.closeModal = function (destroy) {\n\t\tthis.request('close-custom-modal', {destroy: destroy});\n\t\treturn true;\n\t};\n\n\t/**\n\t * Returns the values of all input or select elements within a modal.\n\t *\n\t * The values are keyed by one of the following properties in order of priority: element ID, element name\n\t * or input type + index.\n\t *\n\t * @example\n\t * Given a modal with the following HTML content:\n\t *\n\t *  <form>\n\t *      <input type=\"number\">\n\t *      <input name=\"name\" type=\"text\">\n\t *      <select id=\"languages\">\n\t *          <option selected>en</option>\n\t *          <option>no</option>\n\t *      </select>\n\t *  </form>\n\t *\n\t *  getModalInputs would return:\n\t *\n\t *  {\n\t *      \"number-0\": {VALUE}\n\t *      \"name\": {VALUE},\n\t *      \"languages\": \"en\"\n\t *  }\n\t *\n\t * @param {Function} callback\n\t */\n\tApi.prototype.getModalInputs = function (callback) {\n\t\tthis.request('get-custom-modal-inputs', null, callback);\n\t};\n\n\tApi.prototype.confirmAuthenticated = function () {\n\t\tthis.request('confirm-authenticated', {\n\t\t\tpluginName: this.appName\n\t\t});\n\t};\n\n\tApi.prototype.isStandAlone = function () {\n\t\treturn this.standAlone;\n\n\t};\n\n\t/**\n     * Get the JWT as defined on DrPublish publication config. This token can be used to authenticate the request\n     * @return {*|string}\n     */\n\tApi.prototype.getJWT = function () {\n\t\treturn this.jwt;\n\t};\n\n\tApi.prototype.replaceEditorComponentsExtension = function (data) {\n\t\tthis.request('replace-editor-components-extension', data);\n\t};\n\n\tApi.prototype.clearEditorComponentsExtension = function (data) {\n\t\tthis.request('clear-editor-components-extension', data);\n\t};\n\n\tApi.prototype.highlightAnnotation = function (data) {\n\t\tthis.request('highlight-annotation', data);\n\t};\n\n\tApi.prototype.underemphasizeAnnotations = function (data) {\n\t\tthis.request('underemphasize-annotations', data);\n\t};\n\n\tApi.prototype.registerExternallyDefinedProperties = function (data) {\n\t\tthis.request('register-externally-defined-properties', data);\n\t};\n\n\treturn new Api();\n})();\n\nPluginAPI.Article = articleCommunicator(PluginAPI);\nPluginAPI.Editor = ah5Communicator(PluginAPI);\n\nmodule.exports = PluginAPI;\n"],"sourceRoot":""}